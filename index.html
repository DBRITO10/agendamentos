
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>AGENDAMENTO - MÓVEIS SIMONETTI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Bibliotecas -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- CSS do DataTables -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />

  <style>
    :root {
      --cor-fundo-dashboard: #330000;
      --cor-cabecalho: linear-gradient(90deg, #b30000, #800000);
      --cor-texto-cabecalho: #ffffff;
      --cor-linha-par: #4d0000;
      --cor-linha-impar: #3a0000;
      --cor-filtro: #660000;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--cor-fundo-dashboard);
      color: white;
      padding: 10px;
      margin: 0;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    h1 {
      color: white;
      font-size: 6vw;
      margin: 10px 0 20px 0;
    }

    @media (min-width: 768px) {
      h1 {
        font-size: 28px;
      }
    }

    /* Container com scroll horizontal */
    .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border: 1px solid #660000;
      border-radius: 6px;
    }

    table {
      border-collapse: collapse;
      font-size: 13px;
      width: 100%;
      /* REMOVER table-layout fixed para ajuste automático */
      /* table-layout: fixed; */
      min-width: 800px; /* evita estourar demais, mas menor que 1000px */
    }

    thead tr th {
      background: var(--cor-cabecalho);
      color: var(--cor-texto-cabecalho);
      padding: 10px 6px;
      text-align: center;
      font-weight: bold;
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background-color: var(--cor-linha-par);
    }

    tbody tr:nth-child(odd) {
      background-color: var(--cor-linha-impar);
    }

    td {
      padding: 8px 6px;
      border-bottom: 1px solid #444;
      white-space: nowrap;
      text-align: center;
    }

    /* Defina largura fixa em % para as colunas, somando 100% */
    #planilha th:nth-child(1), #planilha td:nth-child(1) { width: 7%; }   /* Senha */
    #planilha th:nth-child(2), #planilha td:nth-child(2) { width: 9%; }   /* Data */
    #planilha th:nth-child(3), #planilha td:nth-child(3) { width: 11%; }  /* Central */
    #planilha th:nth-child(4), #planilha td:nth-child(4) { width: 13%; }  /* Carga/Transporte */
    #planilha th:nth-child(5), #planilha td:nth-child(5) { width: 10%; }  /* Ordem de Compra */
    #planilha th:nth-child(6), #planilha td:nth-child(6) { width: 8%; }   /* Notas */
    #planilha th:nth-child(7), #planilha td:nth-child(7) { width: 11%; }  /* Status da Carga */
    #planilha th:nth-child(8), #planilha td:nth-child(8) { width: 12%; }  /* Fornecedor */
    #planilha th:nth-child(9), #planilha td:nth-child(9) { width: 12%; }  /* Tipo de Produto */
    #planilha th:nth-child(10), #planilha td:nth-child(10) { width: 12%; }/* Linha de Separação */
    #planilha th:nth-child(11), #planilha td:nth-child(11) { width: 8%; } /* Qtde Volumes */

    /* Filtros */
    .filter-select {
      width: 100%;
      padding: 6px;
      font-size: 13px;
      background: var(--cor-filtro);
      border: none;
      border-radius: 4px;
      color: #eee;
      text-align: center;
      box-sizing: border-box;
    }

    /* Ajustes Mobile */
    @media (max-width: 768px) {
      h1 {
        font-size: 22px;
      }

      .filter-select {
        font-size: 14px;
        padding: 8px;
      }

      td, th {
        font-size: 12px;
        padding: 6px 4px;
      }

      table {
        min-width: 700px;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>AGENDAMENTO - MÓVEIS SIMONETTI</h1>
  </header>

  <div class="table-container">
    <table id="planilha" class="display nowrap">
      <thead>
        <tr class="headers"></tr>
        <tr class="filters"></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const sheetID = "13HL_sWY8BOIoJml3WOMqL-FqDazMgrPDIIoNnJey8ss";
    const gidPinheiros = "0";
    const gidSerra = "1527150749";

    const urls = [
      `https://docs.google.com/spreadsheets/d/${sheetID}/export?format=csv&gid=${gidPinheiros}`,
      `https://docs.google.com/spreadsheets/d/${sheetID}/export?format=csv&gid=${gidSerra}`
    ];

    let allData = [];
    let colunas = [];

    function carregarDados(url, callback) {
      Papa.parse(url, {
        download: true,
        header: true,
        complete: function(results) {
          if (colunas.length === 0) {
            colunas = results.meta.fields;
          }
          allData = allData.concat(results.data);
          callback();
        }
      });
    }

    function inicializarTabela() {
      if (allData.length === 0) return;

      const headerRow = document.querySelector("#planilha thead tr.headers");
      const filterRow = document.querySelector("#planilha thead tr.filters");
      const tableBody = document.querySelector("#planilha tbody");

      colunas.forEach(col => {
        headerRow.innerHTML += `<th>${col}</th>`;
        filterRow.innerHTML += `<th><select class="filter-select"><option value="">Filtrar</option></select></th>`;
      });

      allData.forEach(row => {
        let rowHtml = "<tr>";
        colunas.forEach(col => {
          rowHtml += `<td>${row[col] || ""}</td>`;
        });
        rowHtml += "</tr>";
        tableBody.innerHTML += rowHtml;
      });

      const table = $("#planilha").DataTable({
        paging: false,
        searching: true,
        info: false,
        scrollX: true,
        autoWidth: false,
        language: {
          search: "Buscar:",
          zeroRecords: "Nenhum registro encontrado",
          infoEmpty: "Nenhum dado disponível",
        }
      });

      table.columns().every(function (i) {
        const column = this;
        const select = $(filterRow).find("select").eq(i);
        column.data().unique().sort().each(function (d) {
          if (d) select.append(`<option value="${d}">${d}</option>`);
        });
        select.on("change", function () {
          const val = $.fn.dataTable.util.escapeRegex($(this).val());
          column.search(val ? "^" + val + "$" : "", true, false).draw();
        });
      });
    }

    carregarDados(urls[0], function() {
      carregarDados(urls[1], inicializarTabela);
    });
  </script>
</body>
</html>
